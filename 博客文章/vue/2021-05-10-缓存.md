## activated声明周期

> 通过 `keep-alive` 缓存的页面，如果页面路由地址没有发生变化，则会触发activated钩子函数。

【注】第一次进入页面路由是没有activated钩子的，因为它只存在缓存的页面中。



## 缓存

> 可以简单理解为 数据的暂存区域。

### 为什么需要缓存？

> 可以缓解网络瞬间拥塞（比如某个时刻、瞬间很多人同时访问一个web文档；爆炸性新闻等等....）

### 有什么用？

> 可以提高用户访问体验。
>
> 减少网络带宽的消耗。

### 前端缓存分为两种

#### 1.http缓存

> 强缓存：采用响应头中的 **Cache-Control** 和 **Expires** 两个字段控制。

#### 2.浏览器缓存

> cookie: 主要存储用户信息,大小4KB
>
> LocalStorage: 保存到浏览器内， 大小5mb
>
> SessionStroage
>
> Service Worker: 主要为了提高web app的用户体验，实现离线应用消息推送等等一系列的功能，可以看做是一个独立于浏览器的JavaScript的脚本，在离线状态下也能提供基本功能。



## 案例：

> vue-element-admin 中使用缓存

![image-20210510214600989](C:\Users\wilson\AppData\Roaming\Typora\typora-user-images\image-20210510214600989.png)

```vue
<template>
  <section class="app-main">
    <transition name="fade-transform" mode="out-in">
      <keep-alive :include="cachedViews">
        <router-view :key="key" />
      </keep-alive>
    </transition>
  </section>
</template>

<script>
export default {
  name: 'AppMain',
  computed: {
    cachedViews() {
      return this.$store.state.tagsView.cachedViews
    },
    key() {
      return this.$route.path // 将所有的路径都缓存
    }
  }
}
</script>

```

router.js

```javascript
export const asyncRoutes = [  
    ...
	{
    path: '/icon',
    component: Layout,
  	meta: { title: 'Icons', icon: 'icon', noCache: true } //noCache 不缓存
  },
  // 404 page must be placed at the end !!!
  { path: '*', redirect: '/404', hidden: true }  //hidden 显示隐藏组件
}
    
export default router
```

```vue
// 相当于↓↓↓
<template>
  <div id="app">
    <keep-alive>
      <router-view v-if="$route.meta.keepAlive" /> // v-if控制一些路由不隐藏
    </keep-alive>
  </div>
</template>

//---------------------------------
// 路由页面router.js：
export const router = {
    {
      path: '/aaa',
      name: 'AAA',
      component: () => import('@/views/aaa'),
      meta: {
         keepAlive: false // 不缓存路由
      }
    },
}
```


<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<style>
  #wrap {
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap-reverse;
    height: 500px;
    margin: 20px auto;
    background-color: #eee;
    box-shadow: 0 2px 8px 0 rgba(77, 79, 168, .12);
  }

  #wrap p {
    margin: 0 1px;
    color: #fff;
    background-color: #2ecc71;
  }

  #wrap p:hover {
    cursor: pointer;
  }
</style>

<body>
  <div>
    <input type="text">
    <a>
      <button type="button">左侧入</button>
      <button type="button">右侧入</button>
      <button type="button">左侧出</button>
      <button type="button">右侧出</button>
      <button type="button" id="sort">冒泡</button>
      <button type="button" id="btn">随机50个数字</button>
    </a>
  </div>
  <div id="wrap"></div>
</body>
<script>

  const $ = function (val, type = "single") {
    if (type === 'single') return document.querySelector(val);
    return document.querySelectorAll(val);
  }
  const input = $('input');
  const div = $('#wrap');


  $('a').addEventListener('click', e => {
    // console.log('e', e.target);
    const restrict = input.value > 10 && input.value < 100 ? true : false;
    if (!restrict) {
      return alert('输入的数字必须在10-100之间!')
    } else if (div.childNodes.length > 59) {
      return alert('元素数量最多60个!')
    }

    let p = document.createelem('p');
    p.innerHTML = input.value;
    p.style = `height:${input.value}%;`;

    switch (e.target.innerHTML) {
      case '左侧入':
        div.insertBefore(p, div.firstChild)
        break;
      case '左侧出':
        div.removeChild(div.childNodes[0])
        break;
      case '右侧入':
        div.appendChild(p)
        break;
      case '右侧出':
        div.removeChild(div.lastChild)
        break;
    }
  })


  // 排序节点
  function sortNodelist() {
    let arr = Array.from(div.childNodes).sort((a, b) => a.innerHTML - b.innerHTML)
    let fragment = document.createDocumentFragment();
    arr.forEach(v => {
      fragment.appendChild(v)
    })
    div.innerHTML = '';
    div.appendChild(fragment);
  }



  // 获取随机50个数
  function getNums(n1, n2, nums) {
    let arr = [];
    let m = n2 - n1 + 1; // +1 为了取到100

    for (let i = 0; arr.length < nums; i++) {
      let randomNumBer = Math.floor(Math.random() * m + n1);
      if (arr.includes(randomNumBer)) { // 判断数组是否有重复
        i--;
        continue;
      }
      arr.push(randomNumBer)
    }
    return arr
  }

  // 创建节点
  function createSpan(arr) {
    let content = '';
    arr.forEach(v => {
      content += `<p style="height:${v}%" data-height="${v}">${v}</p>`;
    })
    return content;
  }

  function btn() {
    let arr = getNums(10, 100, 50); // 获取10-100之间 50个数
    let content = createSpan(arr);
    div.innerHTML = content;
  }

  $('#btn').addEventListener('click', e => {
    e.stopPropagation();      // 阻止事件冒泡
    btn();
  });

  $('#sort').addEventListener('click', e => {
    e.stopPropagation();
    sortNodelist();
  });

  //事件绑定函数，兼容浏览器差异
  function addEvent(elem, event, func) {
    if (elem.addEventListener) {
      elem.addEventListener(event, func);
    }
    else if (elem.attachEvent) {
      elem.attachEvent("on" + event, func);
    }
    else {
      elem["on" + event] = func;
    }
  }
  // 删除当前节点
  function delNode(val) {
    div.childNodes.forEach(v => {
      if (val === v.dataset.height) {
        div.removeChild(v)
      }
    })

  }
  addEvent(div, 'click', e => {
    delNode(e.target.dataset.height)
  })

</script>


</html>